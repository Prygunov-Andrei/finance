# –î–µ–Ω—å 12. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (OpenAPI/Swagger)

## 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ drf-spectacular

–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω `drf-spectacular==0.27.1` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ OpenAPI/Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ settings.py

–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ `INSTALLED_APPS`:
- `rest_framework_simplejwt` ‚Äî –¥–ª—è JWT
- `drf_spectacular` ‚Äî –¥–ª—è OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–ù–∞—Å—Ç—Ä–æ–µ–Ω `REST_FRAMEWORK`:
- `DEFAULT_SCHEMA_CLASS`: `drf_spectacular.openapi.AutoSchema`

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ SPECTACULAR_SETTINGS

- **TITLE**: "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç API"
- **DESCRIPTION**: –û–ø–∏—Å–∞–Ω–∏–µ API
- **VERSION**: "1.0.0"
- **TAGS**: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ endpoints –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:
  - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
  - –û–±—ä–µ–∫—Ç—ã
  - –î–æ–≥–æ–≤–æ—Ä—ã
  - –ü–ª–∞—Ç–µ–∂–∏
  - –ü–ª–∞–Ω–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏
  - –ò–º–ø–æ—Ä—Ç—ã

## 2. Endpoints –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### Swagger UI
```
GET /api/docs/
```
–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.

### ReDoc
```
GET /api/redoc/
```
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º.

### OpenAPI Schema (JSON)
```
GET /api/schema/
```
–°—ã—Ä–∞—è OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö.

## 3. –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ ViewSets

–î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã `@extend_schema_view` –∏ `@extend_schema` –¥–ª—è –≤—Å–µ—Ö ViewSets:

### ObjectViewSet
- –û–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è `cash_flow` –∏ `cash_flow_periods` endpoints
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (start_date, end_date, period_type)

### ContractViewSet
- –û–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è `cash_flow` –∏ `cash_flow_periods` endpoints

### PaymentViewSet
- –û–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- –¢–µ–≥–∏ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### PaymentRegistryViewSet
- –û–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- –û—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ–≥ "–ü–ª–∞–Ω–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏"

### ImportLogViewSet
- –û–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–º–ø–æ—Ä—Ç–æ–≤

### UserViewSet
- –û–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è

## 4. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- –í—Å–µ endpoints –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ ViewSets –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –ø–æ–∏—Å–∫–∞ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è
- –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –í Swagger UI –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ "Authorize" –¥–ª—è –≤–≤–æ–¥–∞ JWT —Ç–æ–∫–µ–Ω–∞
- –í—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ endpoints –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ —Ç—Ä–µ–±—É—é—â–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ü—É–±–ª–∏—á–Ω—ã–µ endpoints (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è) –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ —Ç–æ–∫–µ–Ω–∞

### –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–µ–≥–∞–º
–í—Å–µ endpoints —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —Ç–µ–≥–∞–º –¥–ª—è —É–¥–æ–±–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, —Ç–æ–∫–µ–Ω—ã
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –û–±—ä–µ–∫—Ç—ã ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞–º–∏ –∏ cash-flow
- –î–æ–≥–æ–≤–æ—Ä—ã ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞–º–∏ –∏ cash-flow
- –ü–ª–∞—Ç–µ–∂–∏ ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏
- –ü–ª–∞–Ω–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏ ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–æ–º
- –ò–º–ø–æ—Ä—Ç—ã ‚Äî –∂—É—Ä–Ω–∞–ª –∏–º–ø–æ—Ä—Ç–æ–≤

## 5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
1. –û—Ç–∫—Ä—ã—Ç—å `/api/docs/` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ù–∞–∂–∞—Ç—å "Authorize" –∏ –≤–≤–µ—Å—Ç–∏ JWT —Ç–æ–∫–µ–Ω
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å endpoints –ø—Ä—è–º–æ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
4. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å—Ö–µ–º—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤

### –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
1. –ü–æ–ª—É—á–∏—Ç—å OpenAPI —Å—Ö–µ–º—É: `/api/schema/`
2. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Postman, Insomnia –∏–ª–∏ –¥—Ä—É–≥–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫

### –î–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- Swagger UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ endpoints
- –ú–æ–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤
- –í–∏–¥–Ω—ã –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö

## 6. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
python manage.py runserver

# –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
http://localhost:8000/api/docs/  # Swagger UI
http://localhost:8000/api/redoc/  # ReDoc
http://localhost:8000/api/schema/ # OpenAPI JSON
```

### –≠–∫—Å–ø–æ—Ä—Ç —Å—Ö–µ–º—ã
```bash
# –ü–æ–ª—É—á–∏—Ç—å JSON —Å—Ö–µ–º—É
curl http://localhost:8000/api/schema/ > openapi.json

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
# –ù–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ openapi-generator
```

## 7. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞
2. **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç** ‚Äî OpenAPI —Å–æ–≤–º–µ—Å—Ç–∏–º —Å–æ –º–Ω–æ–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
4. **–£–¥–æ–±–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** ‚Äî –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–µ–≥–∞–º
5. **–ü—Ä–∏–º–µ—Ä—ã** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤

## 8. –î–æ—Å—Ç—É–ø –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å–∞–º:
- **Swagger UI**: http://localhost:8000/api/docs/
- **ReDoc**: http://localhost:8000/api/redoc/
- **OpenAPI Schema**: http://localhost:8000/api/schema/

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Swagger UI

1. –û—Ç–∫—Ä–æ–π—Ç–µ `/api/docs/` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Authorize" (üîì) –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
3. –í–≤–µ–¥–∏—Ç–µ JWT —Ç–æ–∫–µ–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ: `Bearer {your_token}`
4. –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ endpoints

### –≠–∫—Å–ø–æ—Ä—Ç —Å—Ö–µ–º—ã

```bash
# –≠–∫—Å–ø–æ—Ä—Ç –≤ YAML
python manage.py spectacular --file schema.yaml

# –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON
python manage.py spectacular --file schema.json
```

## 9. –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö endpoints
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ö–µ–º—ã –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏—è –æ—à–∏–±–æ–∫ –∏ –∫–æ–¥–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å CI/CD –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

